$(function(){function t(){$("#users-table").DataTable()}function e(){$("#toys-table").DataTable()}function a(){if($(window).width()>768){var t=$("#gallery").height();$("#main").css("margin-bottom",.92*t+"px")}}function i(){$("#gallery .grid .item .img").each(function(t,e){var a=$(this).children("img").height();a<274?$(this).css("min-height","240px"):$(this).css("min-height","")}),$("#gallery .grid").jScrollPane({animateDuration:150,autoReinitialise:!0,animateScroll:!1,horizontalGutter:0,hideFocus:!0,contentWidth:"0px",contentWidth:"0px"}),$(".vote").on("click",function(t){t.preventDefault();var e=$(this),a=new FormData,i=e.attr("data");if("openmodal"==i)$(".rememeber").fadeIn(300).children().on("click",function(t){t.preventDefault(),$(this).parent().fadeOut(300)});else{var n=e.siblings(".price").text();n=parseInt(n),a.append("id",i),a.append("vote",n),$.ajax({url:"/services/vote.php",type:"POST",data:a,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(t){1!=t?swal({text:"Error",type:"error",confirmButtonColor:"#fb8f22"}):(e.siblings(".price").text(n+100+" puntos"),swal({text:"Gracias por votar",type:"success",confirmButtonColor:"#fb8f22"}))}})}})}function n(t,e){if(t.files&&t.files[0]){var a=new FileReader;a.onload=function(t){e.attr("src",t.target.result)},a.readAsDataURL(t.files[0])}}function o(t){var e=document.createElement("canvas"),a=t.naturalWidth,i=t.naturalHeight;e.width=a,e.height=i;var n=e.getContext("2d");n.drawImage(t,0,0,a,i);var o=e.toDataURL({format:"image/jpeg",quality:65});return o=o.replace(/^data:image\/(png|jpg|jpeg);base64,/,"")}function s(t){t.formValidation({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{nametoy:{validators:{notEmpty:{message:" "},stringLength:{min:3,max:30,message:" "}}},nameCliente:{validators:{notEmpty:{message:" "},stringLength:{min:3,max:30,message:" "}}},lastnameClient:{validators:{notEmpty:{message:" "},stringLength:{min:3,max:30,message:" "}}},identification:{validators:{notEmpty:{message:" "},numeric:{message:" ",thousandsSeparator:""}}},phone:{validators:{notEmpty:{message:" "},numeric:{message:" ",thousandsSeparator:""}}},mail:{validators:{notEmpty:{message:" "},regexp:{regexp:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,message:"Error"},stringLength:{min:3,max:30,message:" "}}},country:{validators:{notEmpty:{message:" "},stringLength:{min:3,max:30,message:" "}}},nametoy:{validators:{notEmpty:{message:" "},stringLength:{min:3,max:30,message:" "}}},bill:{validators:{notEmpty:{message:" "},file:{extension:"jpeg,jpg,png",type:"image/jpeg,image/png",maxSize:2097152,message:"The selected file is not valid"}}},toy:{validators:{notEmpty:{message:" "},file:{extension:"jpeg,jpg,png",type:"image/jpeg,image/png",maxSize:2097152,message:"The selected file is not valid"}}},terms:{validators:{notEmpty:{message:" "}}}}}).on("success.form.fv",function(t){var e=$(t.target),n=new FormData;e.find("input.form-control").each(function(t,e){var a=$(this).val();""!=a&&n.append($(this).attr("name"),a)}),e.find("input.file").each(function(t,e){"undefined"!=typeof this.files[0]&&n.append($(this).attr("name"),o($(this).siblings("img")[0]))}),swal({title:"Cargando..",showCancelButton:!1,showConfirmButton:!1,showCloseButton:!1}),$.ajax({url:"services/upload-form.php",type:"POST",data:n,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(t){$.get("includes/gallery.php",function(t){$("#gallery").replaceWith(t),setTimeout(function(){i(),a()},1e3)}),e.removeClass("load"),swal({title:"Felicitaciones",text:"Tu juguete se ha publicado exitosamente!",type:"success",confirmButtonColor:"#fb8f22"}),e.find("input.form-control").each(function(t,e){$(this).val("")}),e.find("input.file").each(function(t,e){$(this).val(""),$(this).siblings("img").attr("src","")}),e.find(".btn-sb").prop("disabled",!1).removeClass("disabled"),e.data("formValidation").destroy(),s(e)}})})}function r(t){console.log(t),t.formValidation({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{user:{validators:{notEmpty:{message:" "},stringLength:{min:3,max:30,message:" "},regexp:{regexp:/^[a-zA-Z0-9_\.]+$/,message:"Error"}}},pwd:{validators:{notEmpty:{message:" "},stringLength:{min:3,max:30,message:" "},regexp:{regexp:/^[a-zA-Z0-9_\.]+$/,message:"Error"}}}}}).on("success.form.fv",function(t){t.preventDefault();var e=$(t.target),a=new FormData;e.find("input.form-control").each(function(t,e){var i=$(this).val();""!=i&&a.append($(this).attr("name"),i)}),$.ajax({url:"/services/loginuserProcess.php",type:"POST",data:a,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(t){console.log(t),e.find(".btn").prop("disabled",!1).removeClass("disabled"),e.data("formValidation").destroy(),r(e),window.location.href="/"}})})}function l(){$(".tables .btn").on("click",function(t){t.preventDefault();var e=$(this),a=$(this).attr("data"),i=$(this).parents("tr").first().attr("data"),n=new FormData,o="",s="";0==i?(i=1,o="Activo",s="Inhabilitar"):1==i&&(i=0,o="Inactivo",s="Habilitar"),n.append("id",a),n.append("state",i),$.ajax({url:"/services/disabledEnable.php",type:"POST",data:n,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(t){console.log(t),"true"==t?(e.parents("tr").first().attr("data",i).find(".state").text(o),e.text(s),e.attr("value",s),swal({title:"Felicitaciones",text:"Se ha guardado tu informacion correctamente",type:"success",confirmButtonColor:"#fb8f22"})):swal({title:"Error",text:"No se pudo guardar tu informacion. Intente mas tarde.",type:"error",confirmButtonColor:"#fb8f22"})}})})}$("#form .form form .field .file").on("change",function(t){if("undefined"!=typeof this.files[0]){var e=this.files[0];n(this,$(this).siblings("img")),console.log(e)}}),s($("#form .form")),t(),e(),$(window).on("load",function(t){i(),a()}),$("#header .links .nav #main-menu ul li").on("click",function(t){t.preventDefault();var e=$("html, body");if(1==$(this).attr("data")){var a=0;e.stop().animate({scrollTop:a},"600","swing")}else if(2==$(this).attr("data")){var a=$("#steps").offset().top-200;e.stop().animate({scrollTop:a},"600","swing")}else if(3==$(this).attr("data")){var a=$("#form").offset().top-200;e.stop().animate({scrollTop:a},"600","swing")}else if(4==$(this).attr("data")){var a=$("#gallery").offset().top-200;e.stop().animate({scrollTop:a},"600","swing")}}),r($(".login.loginuser .formlogin form")),l()});