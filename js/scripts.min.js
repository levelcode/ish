$(function(){function e(){$("#users-table").DataTable()}function t(){$("#toys-table").DataTable()}function a(){$("#gallery").height()<500?$("#main").css("margin-bottom","50px"):$("#main").css("margin-bottom","")}function n(){$("#gallery .grid").jScrollPane({animateDuration:150,autoReinitialise:!0,animateScroll:!1,horizontalGutter:0,hideFocus:!0,contentWidth:"0px",contentWidth:"0px"}),$(".vote").on("click",function(e){e.preventDefault();var t=$(this),a=new FormData,n=t.attr("data"),i=t.siblings(".price").text();i=parseInt(i),a.append("id",n),a.append("vote",i),$.ajax({url:"/services/vote.php",type:"POST",data:a,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(e){t.siblings(".price").text(i+100+" puntos"),swal({text:"Gracias por votar",type:"success",confirmButtonColor:"#fb8f22"})}})})}function i(e,t){if(e.files&&e.files[0]){var a=new FileReader;a.onload=function(e){t.attr("src",e.target.result)},a.readAsDataURL(e.files[0])}}function o(e){var t=document.createElement("canvas"),a=e.naturalWidth,n=e.naturalHeight;t.width=a,t.height=n;var i=t.getContext("2d");i.drawImage(e,0,0,a,n);var o=t.toDataURL({format:"image/jpeg",quality:65});return o}function s(e){e.formValidation({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{nametoy:{validators:{notEmpty:{message:" "},stringLength:{min:6,max:30,message:" "},regexp:{regexp:/^[a-zA-Z0-9_\.]+$/,message:"Error"}}},nameCliente:{validators:{notEmpty:{message:" "},stringLength:{min:6,max:30,message:" "},regexp:{regexp:/^[a-zA-Z0-9_\.]+$/,message:"Error"}}},lastnameClient:{validators:{notEmpty:{message:" "},stringLength:{min:6,max:30,message:" "},regexp:{regexp:/^[a-zA-Z0-9_\.]+$/,message:"Error"}}},identification:{validators:{notEmpty:{message:" "},stringLength:{min:6,max:30,message:" "},regexp:{regexp:/^[a-zA-Z0-9_\.]+$/,message:"Error"}}},phone:{validators:{notEmpty:{message:" "},stringLength:{min:6,max:30,message:" "},regexp:{regexp:/^[a-zA-Z0-9_\.]+$/,message:"Error"}}},mail:{validators:{notEmpty:{message:" "},stringLength:{min:6,max:30,message:" "}}},country:{validators:{notEmpty:{message:" "},stringLength:{min:6,max:30,message:" "},regexp:{regexp:/^[a-zA-Z0-9_\.]+$/,message:"Error"}}},nametoy:{validators:{notEmpty:{message:" "},stringLength:{min:6,max:30,message:" "},regexp:{regexp:/^[a-zA-Z0-9_\.]+$/,message:"Error"}}},bill:{validators:{notEmpty:{message:" "},file:{extension:"jpeg,jpg,png",type:"image/jpeg,image/png",maxSize:2097152,message:"The selected file is not valid"}}},toy:{validators:{notEmpty:{message:" "},file:{extension:"jpeg,jpg,png",type:"image/jpeg,image/png",maxSize:2097152,message:"The selected file is not valid"}}}}}).on("success.form.fv",function(e){var t=$(e.target),i=new FormData;t.find("input.form-control").each(function(e,t){var a=$(this).val();""!=a&&i.append($(this).attr("name"),a)}),t.find("input.file").each(function(e,t){"undefined"!=typeof this.files[0]&&i.append($(this).attr("name"),o($(this).siblings("img")[0]))}),$.ajax({url:"services/upload-form.php",type:"POST",data:i,cache:!1,contentType:!1,processData:!1,type:"POST",xhr:function(){return myXhr=$.ajaxSettings.xhr(),myXhr.upload&&(t.addClass("load"),swal({title:"Cargando..",showCancelButton:!1,showConfirmButton:!1,showCloseButton:!1}),myXhr.upload.addEventListener("progress",function(e){},!1)),myXhr},success:function(e){$.get("includes/gallery.php",function(e){$("#gallery").replaceWith(e),n(),setTimeout(function(){a()},1e3)}),t.removeClass("load"),swal({title:"Felicitaciones",text:"Se ha guardado tu informacion correctamente",type:"success",confirmButtonColor:"#fb8f22"}),t.find("input.form-control").each(function(e,t){$(this).val("")}),t.find("input.file").each(function(e,t){$(this).val(""),$(this).siblings("img").attr("src","")}),t.find(".btn-sb").prop("disabled",!1).removeClass("disabled"),t.data("formValidation").destroy(),s(t)}})})}function r(e){console.log(e),e.formValidation({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{user:{validators:{notEmpty:{message:" "},stringLength:{min:6,max:30,message:" "},regexp:{regexp:/^[a-zA-Z0-9_\.]+$/,message:"Error"}}},pwd:{validators:{notEmpty:{message:" "},stringLength:{min:6,max:30,message:" "},regexp:{regexp:/^[a-zA-Z0-9_\.]+$/,message:"Error"}}}}}).on("success.form.fv",function(e){e.preventDefault();var t=$(e.target),a=new FormData;t.find("input.form-control").each(function(e,t){var n=$(this).val();""!=n&&a.append($(this).attr("name"),n)}),$.ajax({url:"/services/loginuserProcess.php",type:"POST",data:a,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(e){console.log(e),t.find(".btn").prop("disabled",!1).removeClass("disabled"),t.data("formValidation").destroy(),r(t),window.location.href="/"}})})}function l(){$(".tables .btn").on("click",function(e){e.preventDefault();var t=$(this),a=$(this).attr("data"),n=$(this).parents("tr").first().attr("data"),i=new FormData,o="",s="";0==n?(n=1,o="Activo",s="Inhabilitar"):1==n&&(n=0,o="Inactivo",s="Habilitar"),i.append("id",a),i.append("state",n),$.ajax({url:"/services/disabledEnable.php",type:"POST",data:i,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(e){console.log(e),"true"==e?(t.parents("tr").first().attr("data",n).find(".state").text(o),t.text(s),t.attr("value",s),swal({title:"Felicitaciones",text:"Se ha guardado tu informacion correctamente",type:"success",confirmButtonColor:"#fb8f22"})):swal({title:"Error",text:"No se pudo guardar tu informacion. Intente mas tarde.",type:"error",confirmButtonColor:"#fb8f22"})}})})}$("#form .form form .field .file").on("change",function(e){if("undefined"!=typeof this.files[0]){var t=this.files[0];i(this,$(this).siblings("img")),console.log(t)}}),s($("#form .form")),n(),e(),t(),$(window).on("load",function(e){a()}),r($(".login.loginuser .formlogin form")),l()});